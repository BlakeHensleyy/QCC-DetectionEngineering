version: 1.1
file_type: data-source-administration
name: 'EDR: Microsoft Defender for Endpoint (MDE)'
domain: enterprise-attack
systems:
  - applicable_to: Windows
    platform:
      - Windows
  - applicable_to: Linux
    platform:
      - Linux
data_sources:
  # Process Activity - Both Platforms
  - data_source_name: Process Creation
    data_source:
      - applicable_to:
          - Windows
          - Linux 
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Full support on Windows and Linux'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  - data_source_name: Process Access
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Windows only - Full support'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  - data_source_name: Process Modification
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Process Tampering Activity - Full support'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  - data_source_name: Process Metadata
    data_source:
      - applicable_to:
          - Windows
          - Linux 
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Available via process creation events'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  # Module/Library Activity - Windows
  - data_source_name: Module Load
    data_source:
      - applicable_to:
          - Windows
          - Linux
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Image/Library Loaded - Windows and Linux'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  # File Activity - Both Platforms
  - data_source_name: File Creation
    data_source:
      - applicable_to:
          - Windows
          - Linux 
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Full support on Windows and Linux'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  - data_source_name: File Deletion
    data_source:
      - applicable_to:
          - Windows
          - Linux 
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Full support on Windows and Linux'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  - data_source_name: File Modification
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Includes file modification and renaming - Full support'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
      - applicable_to:
          - Linux
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Partial support on Linux'
        data_quality:
          device_completeness: 3
          data_field_completeness: 3
          timeliness: 5
          consistency: 3
          retention: 5
  
  # Network Activity - Both Platforms
  - data_source_name: Network Connection Creation
    data_source:
      - applicable_to:
          - Windows
          - Linux 
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'TCP connections on both platforms - Full support'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  - data_source_name: Network Traffic Flow
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'DNS queries, TCP flows - Full support on Windows'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  - data_source_name: Network Traffic Content
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'URL and DNS query monitoring - Full support'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  - data_source_name: Network Share Access
    data_source:
      - applicable_to:
          - Linux
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Network socket listen events'
        data_quality:
          device_completeness: 5
          data_field_completeness: 4
          timeliness: 5
          consistency: 5
          retention: 5
  
  # User Account Activity
  - data_source_name: User Account Authentication
    data_source:
      - applicable_to:
          - Windows
          - Linux 
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Login on Windows, login/failed on Linux - Full support'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  - data_source_name: User Account Creation
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Windows only - Full support'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  - data_source_name: User Account Deletion
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Windows only - Full support'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  - data_source_name: User Account Modification
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Full support'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  # Windows Registry - Windows Only
  - data_source_name: Windows Registry Key Creation
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Full support'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  - data_source_name: Windows Registry Key Modification
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Full support'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  - data_source_name: Windows Registry Key Deletion
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Full support'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  # Scheduled Job Activity
  - data_source_name: Scheduled Job Creation
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Windows scheduled tasks - Full support'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  - data_source_name: Scheduled Job Modification
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Windows scheduled tasks - Full support'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  - data_source_name: Scheduled Job Metadata
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Includes deletion events'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  # Service Activity
  - data_source_name: Service Creation
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Windows - Full support'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
      - applicable_to:
          - Linux
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Linux - Partial support'
        data_quality:
          device_completeness: 2
          data_field_completeness: 2
          timeliness: 5
          consistency: 3
          retention: 5
  
  # Driver Activity - Windows
  - data_source_name: Driver Load
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Full support'
        data_quality:
          device_completeness: 3
          data_field_completeness: 3
          timeliness: 5
          consistency: 5
          retention: 5
      - applicable_to:
          - Linux
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Via enabling telemetry'
        data_quality:
          device_completeness: 4
          data_field_completeness: 4
          timeliness: 5
          consistency: 4
          retention: 5
  
  - data_source_name: Driver Metadata
    data_source:
      - applicable_to:
          - Linux
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'eBPF event monitoring - Via enabling telemetry'
        data_quality:
          device_completeness: 4
          data_field_completeness: 4
          timeliness: 5
          consistency: 4
          retention: 5
  
  # Named Pipe - Windows Only
  - data_source_name: Named Pipe Metadata
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Pipe creation and connection - Full support'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  # WMI Activity - Windows Only
  - data_source_name: WMI Creation
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'WMI event consumer, filter, and bindings - Full support'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  # Command Execution
  - data_source_name: Command Execution
    data_source:
      - applicable_to:
          - Windows
          - Linux 
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Via process creation with command line arguments'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  - data_source_name: OS API Execution
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Win32 API Telemetry - Full support'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  # Script Execution
  - data_source_name: Script Execution
    data_source:
      - applicable_to:
          - Windows
          - Linux 
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'PowerShell on Windows, script content on Linux - Full support'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  # Active Directory - Windows Only
  - data_source_name: Active Directory Object Modification
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Group Policy modification'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  # Drive Operations - Windows Only
  - data_source_name: Drive Creation
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'Virtual disk mount, USB device mount - Full support'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  - data_source_name: Drive Modification
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'USB mount/unmount - Full support'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
  
  # DeTT&CT Custom Data Sources
  - data_source_name: Internal DNS [DeTT&CT data source]
    data_source:
      - applicable_to:
          - Windows
        date_registered: null
        date_connected: null
        products:
          - Microsoft Defender for Endpoint
        available_for_data_analytics: true
        comment: 'DNS query logging available on Windows'
        data_quality:
          device_completeness: 5
          data_field_completeness: 5
          timeliness: 5
          consistency: 5
          retention: 5
